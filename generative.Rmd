---
title: "R Notebook"
output: html_notebook
---

With thanks to flowingdata for original pointer.
http://www.citizen-statistician.org/2020/05/dipping-my-toes-in-generative-art-with-my-sister/

https://generative.substack.com/p/generative-art-and-r

Danielle Navarro (amongst others) have some amazing generative art in R, for some especially gorgeous ones see:
* http://art.djnavarro.net/gallery/stonetree 
* http://art.djnavarro.net/gallery/native-flora

And Will Chase had a 12 months of aRt project with 12 pretty incredible R based art projects
https://github.com/will-r-chase/aRt



These are some nice packages for this
```{r}
#devtools::install_github("cutterkom/generativeart")
#install.packages("flametree")
#devtools::install_github("thomasp85/ambient")  #See https://ambient.data-immaginist.com
#devtools::install_github("djnavarro/jasmines")
#devtools::install_github("marcusvolz/mathart")
#devtools::install_github("Ijeamakaanyene/contouR")
library(contouR) #useful for generative art
library(aRtsy)
library(generativeart)
library(flametree)
library(jasmines)
library(mathart)
```

As https://cpastem.caltech.edu/documents/18024/ARt.nb.html discusses you can also create some quite nice things with more basic packages
```{r}
library(tidyverse)
N <- 30
cols <- rainbow(N)
cols <- c("#EF892D", "#FEC784", "#45555F", "#93ADC5", "#BF49DB")
#set.seed(43)

tibble(line = 1:N %% 5,
       x1 = runif(N, -1, 1),
       y1 = runif(N, -1, 1), 
       x2 = runif(N, -1, 1),
       y2 = runif(N, -1, 1), 
       size = runif(N, 0, 3),
       alpha = runif(N, 0.1, 0.9)) %>% 
  ggplot()+
  geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2, size = size, alpha = alpha, color = as.factor(line)),show.legend = FALSE)+
  scale_color_manual(values = cols)+
  scale_size_continuous(range = c(2,20))+
  theme_void()+
  labs(subtitle = "Rainbow Lines")

seq(-2,2, by = 0.01) %>% 
  expand.grid(x=., y=.) %>% 
  ggplot(aes(x = x^3 - sin(y), y = y^3 - cos(x)))+
  geom_point(alpha = 0.05, color = "black", shape = 20, size = 0)+
  theme_void()+
  coord_polar()+
  labs(subtitle = "Dandelion")

```

Similarly, to create trees https://fronkonstin.com/2017/07/18/plants/
(with more explanation of the L-system here https://fronkonstin.com/2017/06/26/a-shiny-app-to-draw-curves-based-on-l-systems/)
From that "Denoting F as the action of drawing a line of length d and + as turning 90 degrees right, the whole process to draw a square can be represented as F+F+F+F."


```{r}
library(gsubfn)
library(stringr)
library(dplyr)
library(ggplot2)
 
#Plant 1
axiom="F"
rules=list("F"="FF-[-F+F+F]+[+F-F-F]")
angle=22.5
depth=4
 
#Plant 2
axiom="X"
rules=list("X"="F[+X][-X]FX", "F"="FF")
angle=25.7
depth=7
 
#Plant 3
axiom="X"
rules=list("X"="F[+X]F[-X]+X", "F"="FF")
angle=20
depth=7
 
#Plant 4
axiom="X"
rules=list("X"="F-[[X]+X]+F[+FX]-X", "F"="FF")
angle=22.5
depth=5
 
#Plant 5
axiom="F"
rules=list("F"="F[+F]F[-F]F")
angle=25.7
depth=5
 
#Plant 6
axiom="F"
rules=list("F"="F[+F]F[-F][F]")
angle=20
depth=5
 
######################################
######################################
####Pick a plant, and use its rules###

#replace 
for (i in 1:depth) axiom=gsubfn(".", rules, axiom)
 
actions=str_extract_all(axiom, "\\d*\\+|\\d*\\-|F|L|R|\\[|\\]|\\|") %>% unlist
 
status=data.frame(x=numeric(0), y=numeric(0), alfa=numeric(0))
points=data.frame(x1 = 0, y1 = 0, x2 = NA, y2 = NA, alfa=90, depth=1)
 
 
for (action in actions) 
{
  if (action=="F")
  {
    x=points[1, "x1"]+cos(points[1, "alfa"]*(pi/180))
    y=points[1, "y1"]+sin(points[1, "alfa"]*(pi/180))
    points[1,"x2"]=x
    points[1,"y2"]=y
    data.frame(x1 = x, y1 = y, x2 = NA, y2 = NA, 
               alfa=points[1, "alfa"],
               depth=points[1,"depth"]) %>% rbind(points)->points
  }
  if (action %in% c("+", "-")){
    alfa=points[1, "alfa"]
    points[1, "alfa"]=eval(parse(text=paste0("alfa",action, angle)))
  }
  if(action=="["){ 
    data.frame(x=points[1, "x1"], y=points[1, "y1"], alfa=points[1, "alfa"]) %>% 
      rbind(status) -> status
    points[1, "depth"]=points[1, "depth"]+1
  }
   
  if(action=="]"){ 
    depth=points[1, "depth"]
    points[-1,]->points
    data.frame(x1=status[1, "x"], y1=status[1, "y"], x2=NA, y2=NA, 
               alfa=status[1, "alfa"],
               depth=depth-1) %>% 
      rbind(points) -> points
    status[-1,]->status
  }
}
 
ggplot() + 
  geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2), 
               lineend = "round", 
               colour="white",
               data=na.omit(points)) + 
  coord_fixed(ratio = 1) +
  theme(legend.position="none",
        panel.background = element_rect(fill="black"),
        panel.grid=element_blank(),
        axis.ticks=element_blank(),
        axis.title=element_blank(),
        axis.text=element_blank())
```


From jasmines package
```{r}
use_seed(1) %>%
  entity_circle(grain = 1000) %>%
  unfold_tempest(iterations = 10) %>%
  style_ribbon(background = "wheat")

```

The flametree is one of the nicest. I am trying to work out if this could be integrated with the message tree idea - i.e., combine randomness, with an abstraction of message data, to produce e.g. a message forest
```{r}
#It's in this part the data is generated, with coord_x coord_y id_tree id_time id_path id_leaf id_pathtree id_step seg_deg seg_len seg_col seg_wid
z <- flametree_grow(seed = 2, trees = 10) 




 flametree_grow(seed = 2, trees = 10) %>% 
  flametree_plot(style = "voronoi")
```

from aRtsy (probably nicest easy use)
```{r}
canvas_collatz(colors = '#ff2305', background = '#b2b2b2', n = 40, 
               angle.even = 0.0075, angle.odd = 0.0145, side = TRUE)

set.seed(18)
canvas_segments(colors = colorPalette('dark1'), background = '#f09d38', n = 1000, p = 0.5, H = 0.1)

#the below is red, green, orange, grey, green.  fcfcfb is off quite
pal <- jasmines::palette_manual('#ff2305','#32cd32','#f09d38','#b2b2b2','#09D36A')
#color(blue) uses the color: #0f4beb
#color(rich blue) uses the color: #0d41d1

set.seed(18)
canvas_segments(colors = c('#ff2305','#32cd32','#f09d38','#b2b2b2','#0f4beb','#0d41d1'), background = '#fcfcfb', n = 1000, p = 0.5, H = 0.1)



canvas_squares(colors = c('#ff2305','#32cd32','#f09d38','#b2b2b2','#0f4beb','#0d41d1'),

               
set.seed(6)

canvas_squares(colors = c('#ff2305','#b2b2b2','#0f4beb'),
               cuts = 100, ratio = 1.1, width = 100, height = 100)
```
